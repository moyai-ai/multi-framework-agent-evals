{
  "name": "Dependency Vulnerability Analysis",
  "description": "Test the agent's ability to identify vulnerable and outdated dependencies",
  "initial_context": {
    "repository_url": "https://github.com/example/outdated-deps",
    "analysis_type": "dependencies"
  },
  "conversation": [
    {
      "user": "Check the dependencies in https://github.com/example/outdated-deps for vulnerabilities",
      "expected": {
        "actions": ["fetch_repository_info", "list_repository_files", "get_file_content", "analyze_dependencies"],
        "findings": ["CVE-2021-23385", "CVE-2021-28363", "CVE-2021-3281", "CVE-2020-14343"],
        "severity_contains": ["CRITICAL", "HIGH"],
        "message_contains": ["vulnerable", "CVE", "update", "security"]
      }
    },
    {
      "user": "Which dependencies are most critical to update?",
      "expected": {
        "actions": ["generate_remediation_plan"],
        "message_contains": ["PyYAML", "Django", "Flask", "critical"],
        "provides_cve_details": true
      }
    },
    {
      "user": "Are there any deprecated packages?",
      "expected": {
        "message_contains": ["deprecated", "no longer maintained", "alternative"],
        "provides_alternatives": true
      }
    }
  ],
  "test_files": {
    "requirements.txt": {
      "content": "# Web Framework\nflask==1.1.2\ndjango==2.2.10\n\n# HTTP Library\nrequests==2.20.0\nurllib3==1.24.1\n\n# Data Processing\npyyaml==5.1\npandas==0.24.2\nnumpy==1.16.0\n\n# Database\nsqlalchemy==1.3.0\npsycopg2==2.7.5\n\n# Testing\npytest==4.6.2\n\n# Utilities\npython-dotenv==0.10.3\nclick==7.0",
      "expected_issues": [
        {
          "package": "flask",
          "version": "1.1.2",
          "cve": "CVE-2021-23385",
          "severity": "HIGH"
        },
        {
          "package": "django",
          "version": "2.2.10",
          "cve": "CVE-2021-3281",
          "severity": "HIGH"
        },
        {
          "package": "requests",
          "version": "2.20.0",
          "cve": "CVE-2021-28363",
          "severity": "MEDIUM"
        },
        {
          "package": "pyyaml",
          "version": "5.1",
          "cve": "CVE-2020-14343",
          "severity": "CRITICAL"
        },
        {
          "package": "urllib3",
          "version": "1.24.1",
          "severity": "MEDIUM",
          "issue": "outdated"
        }
      ]
    },
    "package.json": {
      "content": "{\n  \"name\": \"vulnerable-app\",\n  \"version\": \"1.0.0\",\n  \"dependencies\": {\n    \"express\": \"4.16.0\",\n    \"lodash\": \"4.17.11\",\n    \"moment\": \"2.24.0\",\n    \"axios\": \"0.18.0\",\n    \"react\": \"16.4.0\",\n    \"webpack\": \"4.0.0\"\n  },\n  \"devDependencies\": {\n    \"jest\": \"23.0.0\",\n    \"eslint\": \"5.0.0\"\n  }\n}",
      "expected_issues": [
        {
          "package": "express",
          "version": "4.16.0",
          "severity": "MEDIUM",
          "issue": "outdated"
        },
        {
          "package": "lodash",
          "version": "4.17.11",
          "cve": "CVE-2019-10744",
          "severity": "HIGH"
        },
        {
          "package": "axios",
          "version": "0.18.0",
          "severity": "MEDIUM",
          "issue": "security updates available"
        }
      ]
    }
  },
  "metadata": {
    "test_type": "dependencies",
    "priority": "high",
    "estimated_duration": 30,
    "tags": ["dependencies", "CVE", "security", "supply-chain"]
  }
}